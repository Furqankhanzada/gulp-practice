var passport=require("passport"),LocalStrategy=require("passport-local").Strategy;exports.setup=function(e,s){passport.use(new LocalStrategy({usernameField:"email",passwordField:"password"},function(s,r,t){e.findOne({email:s.toLowerCase()},function(e,s){return e?t(e):s?s.authenticate(r)?t(null,s):t(null,!1,{message:"This password is not correct."}):t(null,!1,{message:"This email is not registered."})})}))};