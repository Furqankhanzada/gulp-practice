"use strict";var express=require("express"),favicon=require("serve-favicon"),morgan=require("morgan"),compression=require("compression"),bodyParser=require("body-parser"),methodOverride=require("method-override"),cookieParser=require("cookie-parser"),errorHandler=require("errorhandler"),path=require("path"),config=require("./environment"),passport=require("passport");module.exports=function(e){var r=e.get("env");e.set("views",config.root+"/server/views"),e.engine("html",require("ejs").renderFile),e.set("view engine","html"),e.use(compression()),e.use(bodyParser.urlencoded({extended:!1})),e.use(bodyParser.json()),e.use(methodOverride()),e.use(cookieParser()),e.use(passport.initialize()),"production"===r&&(e.use(favicon(path.join(config.root,"public","favicon.ico"))),e.use(express["static"](path.join(config.root,"public"))),e.set("appPath",config.root+"/public"),e.use(morgan("dev"))),("development"===r||"test"===r)&&(e.use(require("connect-livereload")()),e.use(express["static"](path.join(config.root,".tmp"))),e.use(express["static"](path.join(config.root,"client"))),e.set("appPath","client"),e.use(morgan("dev")),e.use(errorHandler()))};